syntax = "proto3";

message ShiftServerData {

	MSBaseEventId basevtid = 1;
	MSServerEvent svevtid = 2;  // Event type
	MSPlayerEvent plevtid = 3;  // Sub ev type

	SessionData Session = 4; // SessionData
	ClientData ClientInfo = 5; // ClientData
	CommonAccountData AccountData = 6;
	RoomData RoomData = 7;
	Account Account = 8;

	repeated sGameObject WorldState = 9; // GameObjects list
	ObjectAction Interaction = 10;

	PlayerObject sPlayerObject = 11;

	ShiftServerError ErrorReason = 12;

}

/// Control message ID.
enum MSBaseEventId
{
	PlayerEvent = 0;
	ServerEvent = 1;
};

/// Control message ID.
enum MSPlayerEvent
{

	//Interaction events
	WORLD_UPDATE = 0;
	MOVE = 1;
	ATTACK = 2;
	DEAD = 3;
	USE = 4;
	CREATE_PLAYER = 5;

};

enum MSServerEvent
{
	LOGIN = 0;	
	LOGIN_FAILED = 1;
	PUBLIC_MESSAGE = 2;						
	ROOM_JOIN = 3;						
	ROOM_CREATE = 4;						
	ROOM_DELETE = 5;						
	ROOM_GET_INFO = 6;						
	ROOM_JOIN_FAILED = 7;		
	CONNECTION = 8;			
	CONNECTION_FAILED = 9;			
	CONNECTION_LOST = 10;			
	PING_REQUEST = 11;				
}
enum ShiftServerError
{
	CLIENT_VER_OLD = 0; // Application.version
	BAD_SESSION = 1;		  // Session
	WRONG_LOGIN_CREDENTIALS = 2; // Wrong login credentials
	WRONG_CLIENT_DATA = 3; // Wrong client credentials
	NO_RESPOND_SERVER = 4; // Connection lost

}
message SessionData {
	string sid = 2;
}

message CommonAccountData {
	string username = 1;
	int32 virtualMoney = 2;
	int32 virtualSpecialMoney = 3;
}

message RoomData {

	repeated ServerRoom rooms = 1;

}

message ServerRoom {

	int32 roomId = 1;
	string name = 2;
	int32 maxUser = 3;
	int32 currentUser = 4;

}

message Account {

	string username = 1;
	string password = 2;

}

message ObjectAction {

	sGameObject currentObject = 1;
	repeated sGameObject interactedObjects = 2;
}

message ClientData {

	string ver = 1;
	string loginname = 2;
	string machine_name = 3;
	string machine_id = 4;
}

message sGameObject {

	int32 oid = 1;

	float pos_x = 2;
	float pos_y = 3;
	float pos_z = 4;

}


message PlayerObject {

	sGameObject pObject = 1;
	PlayerClass pClass = 2;
	int32 currentHp = 3;
	int32 maxHp = 4;
	repeated PlayerInput playerInputs = 5;

}

enum PlayerClass {

	Warrior = 0;
	Archer = 1;
	Mage = 2;
	Priest = 3;
}

message PlayerInput {
	
	float pos_x = 1;
	float pos_y = 2;
	float pos_z = 3;

}

